
Currently Loaded Modules:
  1) intel/18.0.2   4) autotools/1.2   7) TACC
  2) impi/18.0.2    5) cmake/3.16.1    8) python3/3.7.0
  3) git/2.24.1     6) xalt/2.9.6      9) cuda/11.0     (g)

  Where:
   g:  built for GPU

 

/work2/08261/evanat/maverick2/n2n-pytorch/.venv/lib/python3.7/site-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
/work2/08261/evanat/maverick2/n2n-pytorch/src/utils.py:113: UserWarning: Using a target size (torch.Size([3, 128, 128])) that is different to the input size (torch.Size([3, 256, 256])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  return 10 * torch.log10(1 / F.mse_loss(input, target))
Traceback (most recent call last):
  File "src/test.py", line 48, in <module>
    n2n.test(test_loader, show=params.show_output)
  File "/work2/08261/evanat/maverick2/n2n-pytorch/src/noise2noise.py", line 188, in test
    create_montage(img_name, self.p.noise_type, save_path, source_imgs[i], denoised_imgs[i], clean_imgs[i], show)
  File "/work2/08261/evanat/maverick2/n2n-pytorch/src/utils.py", line 132, in create_montage
    psnr_vals = [psnr(source_t, clean_t), psnr(denoised_t, clean_t)]
  File "/work2/08261/evanat/maverick2/n2n-pytorch/src/utils.py", line 113, in psnr
    return 10 * torch.log10(1 / F.mse_loss(input, target))
  File "/work2/08261/evanat/maverick2/n2n-pytorch/.venv/lib/python3.7/site-packages/torch/nn/functional.py", line 3089, in mse_loss
    expanded_input, expanded_target = torch.broadcast_tensors(input, target)
  File "/work2/08261/evanat/maverick2/n2n-pytorch/.venv/lib/python3.7/site-packages/torch/functional.py", line 73, in broadcast_tensors
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
RuntimeError: The size of tensor a (256) must match the size of tensor b (128) at non-singleton dimension 2
