
Currently Loaded Modules:
  1) intel/18.0.2   4) autotools/1.2   7) TACC
  2) impi/18.0.2    5) cmake/3.16.1    8) python3/3.7.0
  3) git/2.24.1     6) xalt/2.9.6      9) cuda/11.0     (g)

  Where:
   g:  built for GPU

 

Traceback (most recent call last):
  File "src/train.py", line 60, in <module>
    n2n.train(train_loader, valid_loader)
  File "/work2/08261/evanat/maverick2/n2n-pytorch/src/noise2noise.py", line 252, in train
    for batch_idx, (source, target) in enumerate(train_loader):
  File "/work2/08261/evanat/maverick2/n2n-pytorch/.venv/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 521, in __next__
    data = self._next_data()
  File "/work2/08261/evanat/maverick2/n2n-pytorch/.venv/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 561, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/work2/08261/evanat/maverick2/n2n-pytorch/.venv/lib/python3.7/site-packages/torch/utils/data/_utils/fetch.py", line 44, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/work2/08261/evanat/maverick2/n2n-pytorch/.venv/lib/python3.7/site-packages/torch/utils/data/_utils/fetch.py", line 44, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/work2/08261/evanat/maverick2/n2n-pytorch/src/datasets.py", line 170, in __getitem__
    tmp = self._corrupt(img)
  File "/work2/08261/evanat/maverick2/n2n-pytorch/src/datasets.py", line 153, in _corrupt
    return self._add_noise(img)
  File "/work2/08261/evanat/maverick2/n2n-pytorch/src/datasets.py", line 138, in _add_noise
    noise_img = b.create_image(img, p=self.noise_param, style='s')
  File "/work2/08261/evanat/maverick2/n2n-pytorch/src/bern_utils_PIL.py", line 67, in create_image
    choice = rand.choice([grid1, grid2])
  File "mtrand.pyx", line 911, in numpy.random.mtrand.RandomState.choice
ValueError: a must be 1-dimensional
